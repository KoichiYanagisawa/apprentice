## 2023/07/31(月)

### 本日の目標(TODO目標/できるようになりたいこと)

- Lambdaが起動するようにレイヤーを作成する。
- CICDにRubocopと単体テストを組み込む。

### 学習時間 (Hour)

- 10.5h

### 目標振り返り(TODO進捗/できるようになりたいこと振り返り)

- LambdaとAPIGatewayとレイヤー関連全て壊してクリーンな状態にする。
- CloudFormationのロールバックがうまく働かず手動で後片付け。
- Lambda起動時に出るエラーを１つずつ依存関係を調べてLambdaのレイヤーを作成。
- ローカルからServerless Frameworkでデプロイテスト。
- 再デプロイ後共有ライブラリが存在しないエラーが解決しないため、原因をLambda環境ではなく、デプロイの過程にあると仮定して調査。
- ローカルからデプロイした時と、GitHubActionsからデプロイした時でエラーの出方が違ったので差異を調査。
- GitHubActionsでデプロイ時OS依存のライブラリが悪さをしていることを発見。原因調査。
- GitHubActions(Ubuntu-latest)とLambda(Amazonlinux:2なのでCentOS寄り)の環境の差を近付ける方法がないか調査。
- GitHubActionsのUbuntu上にDockerコンテナ(Amazonlinux:2)を立ててデプロイできるようにした。
- Lambda起動時に出ていたlibssl.so.3が無いというエラーと、libcrypt.so.1が無いというエラーが発生しなくなった。
- CICDに単体テストとRubocopを追加。

### 詰まっていること(実現したいこと/現状/行ったこと/仮説)

- なし。

### 学んだこと(新しい気付き、学び)

- GitHubActions上のOSにDockerコンテナを立てられること。
- 共有ライブラリ依存を調査する時は、シンボリックリンクが貼られていないか調査しながら進める必要があること。
- ライブラリの依存関係は `ldd` というコマンドで調べることができる。

### 感想(一日の感想、雜談)

- Backendが立ち上がらない状況をなんとか脱した。構築した環境を壊すのはすごく時間がかかったのに、再構築にブループリントを使ったおかげで一瞬で終わった。持っててよかったブループリント。

### 明日の目標(TODO目標/できるようになりたいこと)

- 前回指摘してもらっていたデザインの修正。
- フロントエンド構築中に気になっていたコンポーネントの拡張性向上。
- フロントエンドのテスト方法を調査。
