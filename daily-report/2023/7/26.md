## 2023/07/26(水)

### 本日の目標(TODO目標/できるようになりたいこと)

- APIGatewayでデータがLambdaに届かない原因究明。

### 学習時間 (Hour)

- 11.5h

### 目標振り返り(TODO進捗/できるようになりたいこと振り返り)

- putsを大量にコードに埋め込み、どの時点でどのような形になっているかを確認。
- lambda_function.rbを編集し、Railsへどのように渡すのかを調べながら記述。
- Rails側で受け取り方が全て変わってしまったので繋ぎ直し。
- デグレを起こしてしまったので振り出しに戻る。
- APIGatewayを手動で設定したのをコードに落とし込む。
- S3から有効期限付きのURLを使ってダウンロードしていたが、デプロイしてからダウンロードできたりできなかったりで不安定になってしまう原因を調査。

### 詰まっていること(実現したいこと/現状/行ったこと/仮説)

- Lambdaで一箇所のデータを取得できるようにすると他の箇所でデータが受け取れなくなってしまう。

### 学んだこと(新しい気付き、学び)

- ストリームの終端まで読み込むと２回目は空になっているので`@body = JSON.parse(request.body.read)`のように読み込む時は注意すること。
- 正規表現で強引に変換しなくても、jsonなどは変換できるメソッドがある。

### 感想(一日の感想、雜談)

- jsonの中にエスケープされた値や、ハッシュ、配列が入っていると非常にわかりづらい。何度も見間違えてしまい、値が取得できなくて悩んだ。そもそも寝不足が続いて頭が回らないので、今日は一旦休息を取ることにする。

### 明日の目標(TODO目標/できるようになりたいこと)

- APIGatewayで受け取ったデータをlambda_functionを通じてRailsに全て渡せるようにする。
