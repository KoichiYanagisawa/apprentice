## 2023/07/27(木)

### 本日の目標(TODO目標/できるようになりたいこと)

- APIGatewayで受け取ったデータをlambda_functionを通じてRailsに全て渡せるようにする。

### 学習時間 (Hour)

- 12.0h

### 目標振り返り(TODO進捗/できるようになりたいこと振り返り)

- CloudFrontでOAIを設定しようとしたところ、リファレンスにはOACが推奨されていたのでそちらへ変更。
- APIGatewayで受け取ったデータを一度に変換するのは大変だったので、使う部分だけを抽出してそれぞれ変換することにした。
- S3からAPIGatewayのエンドポイントを叩けることを確認。
- CloudFrontからS3へOACを使って接続できることを確認。
- CloudFrontへACMを設定してhttpリダイレクトできることとSSL化できることを確認。
- GitHubActionsでS3へFrontend環境をデプロイできるようにした。

### 詰まっていること(実現したいこと/現状/行ったこと/仮説)

- APIGatewayもLambdaもDynamoDBもコールドスタートなので最初のレスポンスが非常に悪い。

### 学んだこと(新しい気付き、学び)

- S3の静的ウェブサイトホスティングを使用せずにS3上にFrontend環境を構築できること。
- S3のバケットポリシーの設定方法。
- CloudFrontキャッシュポリシー、オリジンリクエストポリシー、レスポンスヘッダーポリシーで機能を制限する方法。
- Lambda上でのログをCloudWatchへ出力する方法。
- npm ciがひたすらgithub actionsで発生するので、ランナーの実行環境を変えたところ挙動がかわりデプロイできた。

### 感想(一日の感想、雜談)

- 動作確認用で作ったIAMユーザーがたくさんあり、その中でもフルアクセスをつけているユーザーがまだ一部使われているので、極力権限は削ぎ落としておきたい。また何があるかわからないので。。。

### 明日の目標(TODO目標/できるようになりたいこと)

- バックエンドのデプロイで、ローカルでコマンドを実行して行なっているのを、GitHubActionsからそのコマンドを利用できるようにする。
